@inject FirstReg.Service _service

@{
    var user = await _service.Data.Get<User>(x => x.UserName.ToLower() == User.Identity.Name.ToLower());
}

<div id="kt_header" style="" class="header align-items-stretch">
    <div class="container-fluid d-flex align-items-stretch justify-content-between">
        <div class="d-flex align-items-center d-lg-none ms-n3 me-1" title="Show aside menu">
            <div class="btn btn-icon btn-active-light-primary w-40px h-30px w-md-40px h-md-40px" id="kt_aside_mobile_toggle">
                <span class="svg-icon svg-icon-2x mt-1">
                    <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="30px" height="30px" viewBox="0 0 20 20" version="1.1">
                        <g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
                            <rect x="0" y="0" width="30" height="30" />
                            <rect fill="#000000" x="4" y="5" width="16" height="3" rx="1.5" />
                            <path d="M5.5,15 L18.5,15 C19.3284271,15 20,15.6715729 20,16.5 C20,17.3284271 19.3284271,18 18.5,18 L5.5,18 C4.67157288,18 4,17.3284271 4,16.5 C4,15.6715729 4.67157288,15 5.5,15 Z M5.5,10 L18.5,10 C19.3284271,10 20,10.6715729 20,11.5 C20,12.3284271 19.3284271,13 18.5,13 L5.5,13 C4.67157288,13 4,12.3284271 4,11.5 C4,10.6715729 4.67157288,10 5.5,10 Z" fill="#000000" opacity="1" />
                        </g>
                    </svg>
                </span>
            </div>
        </div>
        <div class="d-flex align-items-center flex-grow-1 flex-lg-grow-0">
            <a href="~/" class="d-lg-none">
                <img alt="Logo" src="~/img/logos/logo.png" class="h-50px" />
            </a>
        </div>
        <div class="d-flex align-items-stretch justify-content-between flex-lg-grow-1">
            <div class="d-flex align-items-center" id="kt_header_nav">
                <div data-kt-swapper="true" data-kt-swapper-mode="prepend" data-kt-swapper-parent="{default: '#kt_content_container', 'lg': '#kt_header_nav'}" class="page-title d-flex align-items-center flex-wrap me-3 mb-5 mb-lg-0">
                    <h1 class="d-flex align-items-center text-dark fw-bolder fs-3 my-1">@ViewBag.Title</h1>
                    @if (!string.IsNullOrEmpty(ViewBag.SubTitle))
                    {
                        <span class="h-20px border-gray-200 border-start mx-4"></span>
                        <ul class="breadcrumb breadcrumb-separatorless fw-bold fs-7 my-1">
                            <li class="breadcrumb-item text-dark">@ViewBag.SubTitle</li>
                        </ul>
                    }
                </div>
            </div>
            <div class="d-flex align-items-stretch flex-shrink-0">
                <div class="d-flex align-items-stretch flex-shrink-0">
                    <div class="d-flex align-items-center ms-1 ms-lg-3">
                        <div class="btn btn-icon btn-active-light-primary w-30px h-30px w-md-40px h-md-40px" id="kt_activities_toggle">
                            <span class="svg-icon svg-icon-1">
                                <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="24px" height="24px" viewBox="0 0 24 24" version="1.1">
                                    <g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
                                        <rect x="0" y="0" width="24" height="24" />
                                        <rect fill="#000000" opacity="0.3" x="13" y="4" width="3" height="16" rx="1.5" />
                                        <rect fill="#000000" x="8" y="9" width="3" height="11" rx="1.5" />
                                        <rect fill="#000000" x="18" y="11" width="3" height="9" rx="1.5" />
                                        <rect fill="#000000" x="3" y="13" width="3" height="7" rx="1.5" />
                                    </g>
                                </svg>
                            </span>
                        </div>
                    </div>
                    <div class="d-flex align-items-center ms-1 ms-lg-3" id="kt_header_profile_menu_toggle">
                        <div class="cursor-pointer symbol symbol-30px symbol-md-40px" data-kt-menu-trigger="click" data-kt-menu-attach="parent" data-kt-menu-placement="bottom-end" data-kt-menu-flip="bottom">
                            <img src="~/img/avatars/blank.png" alt="FR Admin" />
                        </div>
                        <div class="menu menu-sub menu-sub-dropdown menu-column menu-rounded menu-gray-800 menu-state-bg menu-state-primary fw-bold py-4 fs-6 w-275px" data-kt-menu="true">
                            <div class="menu-item px-3">
                                <div class="menu-content d-flex align-items-center px-3">
                                    <div class="symbol symbol-50px me-5">
                                        <img alt="Logo" src="~/img/avatars/blank.png" />
                                    </div>
                                    <div class="d-flex flex-column">
                                        <div class="fw-bolder d-flex align-items-center fs-5">
                                            @user.FullName
                                        </div>
                                        <span class="fw-bold text-muted text-hover-primary fs-7">@User.Identity.Name</span>
                                    </div>
                                </div>
                            </div>
                            <div class="separator my-2"></div>
                            <div class="menu-item px-5">
                                <a data-bs-toggle="modal" data-bs-target="#diag_update_profile" class="menu-link px-5">My Profile</a>
                                <a data-bs-toggle="modal" data-bs-target="#diag_update_profile" class="menu-link px-5">Change Password</a>
                            </div>
                            <div class="separator my-2"></div>
                            <div class="menu-item px-5">
                                <a asp-controller="Auth" asp-action="Logout" class="menu-link px-5">Sign Out</a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<div class="modal fade" id="diag_update_profile" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered mw-650px">
        <div class="modal-content">
            <form class="form form-loader" asp-controller="Auth" asp-action="UpdateProfile" id="diag_update_profile_form">
                <div class="modal-header" id="diag_update_profile_header">
                    <h2 class="fw-bolder">Update Profile</h2>
                    <div id="diag_update_profile_close" class="btn btn-icon btn-sm btn-active-icon-primary" data-bs-dismiss="modal">
                        <span class="svg-icon svg-icon-1"> <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="24px" height="24px" viewBox="0 0 24 24" version="1.1"> <g transform="translate(12.000000, 12.000000) rotate(-45.000000) translate(-12.000000, -12.000000) translate(4.000000, 4.000000)" fill="#000000"> <rect fill="#000000" x="0" y="7" width="16" height="2" rx="1" /> <rect fill="#000000" opacity="0.5" transform="translate(8.000000, 8.000000) rotate(-270.000000) translate(-8.000000, -8.000000)" x="0" y="7" width="16" height="2" rx="1" /> </g> </svg> </span>
                    </div>
                </div>
                <input type="hidden" name="@nameof(ProfileModel.Id)" value="@user.Id" />
                <div class="modal-body py-10 px-lg-17">
                    <div class="d-flex flex-column">
                        <div>
                            <div class="row">
                                <div class="col-6">
                                    <div class="fv-row mb-5">
                                        <label class="fs-6 fw-bold mb-2">First name</label>
                                        <input type="text" class="form-control form-control-solid" name="@nameof(ProfileModel.FirstName)" placeholder="@user.FirstName" value="@user.FirstName" required />
                                    </div>
                                </div>
                                <div class="col-6">
                                    <div class="fv-row mb-5">
                                        <label class="fs-6 fw-bold mb-2">Last name</label>
                                        <input type="text" class="form-control form-control-solid" name="@nameof(ProfileModel.LastName)" placeholder="@user.LastName" value="@user.LastName" required />
                                    </div>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-6">
                                    <div class="fv-row mb-5">
                                        <label class="fs-6 fw-bold mb-2">Email address</label>
                                        <input type="text" class="form-control form-control-solid" name="@nameof(ProfileModel.Email)" placeholder="@user.Email" value="@user.Email" required readonly />
                                    </div>
                                </div>
                                <div class="col-6">
                                    <div class="fv-row mb-5">
                                        <label class="fs-6 fw-bold mb-2">Phone number</label>
                                        <input type="text" class="form-control form-control-solid" name="@nameof(ProfileModel.MobileNo)" placeholder="@user.PhoneNumber" value="@user.PhoneNumber" required />
                                    </div>
                                </div>
                            </div>
                            <div class="separator my-10"></div>
                            <div class="row">
                                <div class="col-6">
                                    <div class="fv-row mb-5">
                                        <label class="fs-6 fw-bold mb-2">Username</label>
                                        <input type="text" class="form-control form-control-solid" name="@nameof(ProfileModel.Username)" placeholder="@user.UserName" value="@user.UserName" readonly />
                                    </div>
                                </div>
                                <div class="col-6">
                                    <div class="fv-row mb-5">
                                        <label class="fs-6 fw-bold mb-2">Current Password</label>
                                        <input type="password" class="form-control form-control-solid" name="@nameof(ProfileModel.ExPassword)" placeholder="Current password" />
                                    </div>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-6">
                                    <div class="fv-row mb-5">
                                        <label class="fs-6 fw-bold mb-2">New Password</label>
                                        <input type="password" class="form-control form-control-solid" name="@nameof(ProfileModel.NewPassword)" placeholder="New password" />
                                    </div>
                                </div>
                                <div class="col-6">
                                    <div class="fv-row mb-5">
                                        <label class="fs-6 fw-bold mb-2">Retype Password</label>
                                        <input type="password" class="form-control form-control-solid" name="@nameof(ProfileModel.RePassword)" placeholder="Re-enter password" />
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer flex-center">
                    <button type="button" class="btn btn-white me-3" data-bs-dismiss="modal">Cancel</button>
                    <button type="submit" class="btn btn-primary bt-submit"> <span class="indicator-label">Submit</span> <span class="indicator-progress"> Please wait... <span class="spinner-border spinner-border-sm align-middle ms-2"></span> </span> </button>
                </div>
            </form>
        </div>
    </div>
</div>